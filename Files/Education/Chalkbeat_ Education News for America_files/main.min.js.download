function add_email_signup_listeners(){jQuery("form.email-signup").submit(function(e){e.preventDefault();var a=jQuery(this).find("input[name=email]"),n=jQuery(this).find("[name=list]"),t=jQuery(this).find("[name=campaign]"),i=jQuery(this),s={email:a.val(),list:n.val(),campaign:t.val()};if(""===s.email)return!1;a.prop("disabled",!0),n.prop("disabled",!0),i.find('button[type="submit"]').toggleClass("active"),jQuery.post("/wp-json/cb_pardot/email_lists/v1/update",s,function(e){var t=i.find(".response");a.prop("disabled",!1),n.prop("disabled",!1),i.find('button[type="submit"]').toggleClass("active"),e.prospect&&(t.html("Thanks, <em>"+e.prospect.email+"</em> was successfully subscribed."),ga("chalkbeatRollup.send","event","Article","Click","Email Promo Signup Success")),"Invalid API key or user key"==e.err&&(t.html("Whoops. There was a problem. Please try again later."),ga("chalkbeatRollup.send","event","Article","Click","Email Promo Signup API Failure")),"Invalid prospect email address"==e.err?(t.html("Invalid email address. Try again."),ga("chalkbeatRollup.send","event","Article","Click","Email Promo Signup Invalid Address Failure")):t.html(e.err),t.fadeIn()})})}function cb_send_notification(e,t){jQuery.ajax({method:"POST",url:e,data:{content:t}})}function articleInView(e){var t=jQuery(window).scrollTop()-500,a=t+jQuery(window).height()+500,n=jQuery(e).offset().top;return t<=n+jQuery(e).height()&&n<=a}function isElementInViewport(e){"function"==typeof jQuery&&e instanceof jQuery&&(e=e[0]);var t=e.getBoundingClientRect();return 0<=t.top&&0<=t.left&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)+250&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}function scrolledPastTop(e){var t=jQuery(window).scrollTop();return jQuery(e).offset().top<=t}function throttle(e,t){var a=Date.now();return function(){a+t-Date.now()<0&&(e(),a=Date.now())}}!function(o){"use strict";var l=function(e,t){this.$element=o(e),this.options=o.extend({},l.DEFAULTS,t),this.$trigger=o('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};function i(e){var t,a=e.attr("data-target")||(t=e.attr("href"))&&t.replace(/.*(?=#[^\s]+$)/,"");return o(a)}function r(n){return this.each(function(){var e=o(this),t=e.data("bs.collapse"),a=o.extend({},l.DEFAULTS,e.data(),"object"==typeof n&&n);!t&&a.toggle&&/show|hide/.test(n)&&(a.toggle=!1),t||e.data("bs.collapse",t=new l(this,a)),"string"==typeof n&&t[n]()})}l.VERSION="3.3.4",l.TRANSITION_DURATION=350,l.DEFAULTS={toggle:!0},l.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},l.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e,t=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(t&&t.length&&(e=t.data("bs.collapse"))&&e.transitioning)){var a=o.Event("show.bs.collapse");if(this.$element.trigger(a),!a.isDefaultPrevented()){t&&t.length&&(r.call(t,"hide"),e||t.data("bs.collapse",null));var n=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[n](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var i=function(){this.$element.removeClass("collapsing").addClass("collapse in")[n](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!o.support.transition)return i.call(this);var s=o.camelCase(["scroll",n].join("-"));this.$element.one("bsTransitionEnd",o.proxy(i,this)).emulateTransitionEnd(l.TRANSITION_DURATION)[n](this.$element[0][s])}}}},l.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=o.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var t=this.dimension();this.$element[t](this.$element[t]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var a=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!o.support.transition)return a.call(this);this.$element[t](0).one("bsTransitionEnd",o.proxy(a,this)).emulateTransitionEnd(l.TRANSITION_DURATION)}}},l.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},l.prototype.getParent=function(){return o(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(o.proxy(function(e,t){var a=o(t);this.addAriaAndCollapsedClass(i(a),a)},this)).end()},l.prototype.addAriaAndCollapsedClass=function(e,t){var a=e.hasClass("in");e.attr("aria-expanded",a),t.toggleClass("collapsed",!a).attr("aria-expanded",a)};var e=o.fn.collapse;o.fn.collapse=r,o.fn.collapse.Constructor=l,o.fn.collapse.noConflict=function(){return o.fn.collapse=e,this},o(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(e){var t=o(this);t.attr("data-target")||e.preventDefault();var a=i(t),n=a.data("bs.collapse")?"toggle":t.data();r.call(a,n)})}(jQuery),jQuery(document).ready(function(r){var e=r(window).width();r(window).height();if(e<1079)var a="mobile";else a="desktop";r(window).resize(function(){e=r(window).width(),r(window).height(),a=e<1079?"mobile":"desktop"}),add_email_signup_listeners(),r(".filter-bar").find("select[name=location]").change(function(){r(this).closest("form").submit()}),r(".load-more-recent").click(function(e){e.preventDefault();var t=r(this).siblings(".recent-posts-feed"),a=r(this);a.addClass("loading").prop("disabled",!0);var n=a.data("offset"),i=a.data("bureaus"),s=a.data("exclude"),o=a.data("per_page"),l={action:"load_more_recent",offset:n,bureaus:i,exclude:s,per_page:o};"function"==typeof ga&&ga("chalkbeatRollup.send","event",a.data("ga_page"),"click","Load More Recent Articles ("+a.data("offset")+")"),r.post(cb_chalkbeat.ajax_url,l,function(e){t.append(e),n+=o,a.data("offset",n),a.removeClass("loading").prop("disabled",!1)})});var n=r(".site-header"),i=n.height();r(window).scroll(function(e){var t=r(this).scrollTop();i<t&&"desktop"==a?(n.addClass("sticky"),r("body").css("paddingTop",i)):(n.removeClass("sticky"),r("body").css("paddingTop",0))}),r(document).on("click","#load-more-events",function(e){jQuery.ajax({type:"POST",url:"/wp-admin/admin-ajax.php",data:{action:"load_more_events",offset:r(this).attr("data-offset"),cbevent:"false"},dataType:"html"}).done(function(e){if(e){r("#load-more-container").append(e);var t=r("#load-more-events").attr("data-offset");(t=parseInt(t)+1)>r("#load-more-events").data("totalpages")?r("#load-more-events").hide():r("#load-more-events").attr("data-offset",t),"desktop"==a&&leftColBotHeight()}else r("#load-more-events").hide()}),e.preventDefault()}),r(document).on("click","#load-more-events-cb",function(e){jQuery.ajax({type:"POST",url:"/wp-admin/admin-ajax.php",data:{action:"load_more_events",offset:r(this).attr("data-offset"),cbevent:"true"},dataType:"html"}).done(function(e){if(e){r("#load-more-container-cb").append(e);var t=r("#load-more-events-cb").attr("data-offset");(t=parseInt(t)+1)>r("#load-more-events-cb").data("totalpages")?r("#load-more-events-cb").hide():r("#load-more-events-cb").attr("data-offset",t),"desktop"==a&&leftColBotHeight()}else r("#load-more-events-cb").hide()}),e.preventDefault()}),void 0!==r("#event-datetime").datetimepicker&&(r("#event-datetime").datetimepicker({timeFormat:"hh:mm tt"}),r("#event-datetime-end").datetimepicker({timeFormat:"hh:mm tt"})),r("#eventform").submit(function(e){r("#event-fields-message").hide(),""==r("#email").val()?!function(){if(""==r("#event-decription").val()||""==r("#event-datetime").val()||""==r("#event-where").val()||""==r("#event-cost").val()||""==r("#organizer-name").val()||""==r("#organizer-email").val())return!1;if(!new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i).test(r("#organizer-email").val()))return!1;return!0}()?r("#event-fields-message").show():jQuery.ajax({type:"POST",url:"/wp-admin/admin-ajax.php",data:{action:"add_event",name:r("#event-name").val(),description:r("#event-description").val(),datetime:r("#event-datetime").val(),datetimeend:r("#event-datetime-end").val(),location:r("#event-where").val(),cost:r("#event-cost").val(),organizer:r("#organizer-name").val(),email:r("#organizer-email").val(),phone:r("#organizer-phone").val(),trap:r("#email").val()},dataType:"html"}).done(function(e){e&&(r(".event-form").hide(),r("#event-success-message").show())}):(r(".event-form").hide(),r("#event-success-message").show()),e.preventDefault()}),r(document).on("click","#all-events",function(e){r("#all-events").addClass("active"),r("#cb-events").removeClass("active"),r("#all-events-wrapper").show(),r("#cb-events-wrapper").hide(),e.preventDefault()}),r(document).on("click","#cb-events",function(e){r("#cb-events").addClass("active"),r("#all-events").removeClass("active"),r("#cb-events-wrapper").show(),r("#all-events-wrapper").hide(),e.preventDefault()}),function(o){"use strict";var l=function(e,t){this.$element=o(e),this.options=o.extend({},l.DEFAULTS,t),this.$trigger=o('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};function i(e){var t,a=e.attr("data-target")||(t=e.attr("href"))&&t.replace(/.*(?=#[^\s]+$)/,"");return o(a)}function r(n){return this.each(function(){var e=o(this),t=e.data("bs.collapse"),a=o.extend({},l.DEFAULTS,e.data(),"object"==typeof n&&n);!t&&a.toggle&&/show|hide/.test(n)&&(a.toggle=!1),t||e.data("bs.collapse",t=new l(this,a)),"string"==typeof n&&t[n]()})}l.VERSION="3.3.4",l.TRANSITION_DURATION=350,l.DEFAULTS={toggle:!0},l.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},l.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e,t=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(t&&t.length&&(e=t.data("bs.collapse"))&&e.transitioning)){var a=o.Event("show.bs.collapse");if(this.$element.trigger(a),!a.isDefaultPrevented()){t&&t.length&&(r.call(t,"hide"),e||t.data("bs.collapse",null));var n=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[n](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var i=function(){this.$element.removeClass("collapsing").addClass("collapse in")[n](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!o.support.transition)return i.call(this);var s=o.camelCase(["scroll",n].join("-"));this.$element.one("bsTransitionEnd",o.proxy(i,this)).emulateTransitionEnd(l.TRANSITION_DURATION)[n](this.$element[0][s])}}}},l.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=o.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var t=this.dimension();this.$element[t](this.$element[t]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var a=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!o.support.transition)return a.call(this);this.$element[t](0).one("bsTransitionEnd",o.proxy(a,this)).emulateTransitionEnd(l.TRANSITION_DURATION)}}},l.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},l.prototype.getParent=function(){return o(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(o.proxy(function(e,t){var a=o(t);this.addAriaAndCollapsedClass(i(a),a)},this)).end()},l.prototype.addAriaAndCollapsedClass=function(e,t){var a=e.hasClass("in");e.attr("aria-expanded",a),t.toggleClass("collapsed",!a).attr("aria-expanded",a)};var e=o.fn.collapse;o.fn.collapse=r,o.fn.collapse.Constructor=l,o.fn.collapse.noConflict=function(){return o.fn.collapse=e,this},o(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(e){var t=o(this);t.attr("data-target")||e.preventDefault();var a=i(t),n=a.data("bs.collapse")?"toggle":t.data();r.call(a,n)})}(jQuery),function(n){"use strict";n.fn.emulateTransitionEnd=function(e){var t=!1,a=this;n(this).one("bsTransitionEnd",function(){t=!0});return setTimeout(function(){t||n(a).trigger(n.support.transition.end)},e),this},n(function(){n.support.transition=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var a in t)if(void 0!==e.style[a])return{end:t[a]};return!1}(),n.support.transition&&(n.event.special.bsTransitionEnd={bindType:n.support.transition.end,delegateType:n.support.transition.end,handle:function(e){if(n(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})})}(jQuery)}),jQuery(function(e){scroll_checks.run(),e(window).on("scroll",throttle(scroll_checks.run,250))});var scroll_checks={run:function(){var e=jQuery("article.container img, .article-block-side img, .article-block-below img");scroll_checks.images(e);var t=jQuery("article.container");window.article_meta&&(scroll_checks.analytics(t),scroll_checks.ads(t))},images:function(e){for(i=0;i<e.length;i++){var t=jQuery(e[i]);isElementInViewport(t)&&null==t.attr("src")&&(t.attr("src",t.data("src")),t.attr("srcset",t.data("srcset")))}},analytics:function(e){for(i=0;i<e.length;i++){var t=jQuery(e[i]),a=window.article_meta[i],n=t.find("h1"),s=a.permalink,o=a.path,l=a.title+" | Chalkbeat";if(articleInView(t)&&scrolledPastTop(n)){s!==window.location.href&&(window.history.replaceState({pageTitle:l},l,s),document.title=l);var r=void 0!==a.analytics?a.analytics:void 0;if(r&&1<r.article_num){for(var d in ga("chalkbeatRollup.set","page",o),r)ga("chalkbeatRollup.set",d,r[d]);ga("chalkbeatRollup.send","pageview"),r.article_num&&ga("chalkbeatRollup.send","event","Article","Read Next","Article "+r.article_num),a.analytics=null}}}},ads:function(e){for(i=0;i<e.length;i++){var t=jQuery(e[i]);t.find("h1");if(articleInView(t)){var a=void 0!==article_meta[i].ads?article_meta[i].ads:void 0;a&&(googletag.cmd.push(function(){for(var e=0;e<a.length;e++)googletag.pubads().refresh([google_ads[a[e]]])}),article_meta[i].ads=null)}}}};